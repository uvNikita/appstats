{% extends "layout.html" %}
{% block body %}
    <script src="{{ url_for('static', filename='js/flotr2.js') }}"></script>
    <a href="{{ url_for('main_page') }}" class="btn">Home</a>
    <form>
        <span name="hours_radio" class="btn-group" data-toggle="buttons-radio" onclick="_submit()">
            <button name="hours" value="6" class="btn {{ 'active' if hours == 6 else ''}}">6 hours</button>
            <button name="hours" value="12" class="btn {{ 'active' if hours == 12 else ''}}">12 hours</button>
            <button name="hours" value="24" class="btn {{ 'active' if hours == 24 else ''}}">1 day</button>
            <button name="hours" value="144" class="btn {{ 'active' if hours == 144 else ''}}">6 days</button>
            <button name="hours" value="720" class="btn {{ 'active' if hours == 720 else ''}}">30 days</button>
        </span>
        <select name="field" onchange="_submit()">
            {% for field in fields %}
                <option {{ 'selected' if field == selected_field else ''}}> {{ field }} </option>
            {% endfor %}
        </select>
        <input name="name" type="hidden" value="{{ name }}"/>
    </form>
    <div style="height: 400px;" id="graph"></div>

    <script>
        function _submit() {
            field = $('select[name="field"]').val();
            hours = $('button[name="hours"].active').val();
            document.location.href="{{ url_for('info_page', name=name)}}" +
            '&' + $.param([
                {name : 'field', value : field},
                {name : 'hours', value : hours}
            ])
        }

        function basic_time(container, data, field, name) {
            var options;

            options = {
                xaxis : {
                    mode : 'time',
                    labelsAngle : 45,
                    timeMode : 'local'
                },
                yaxis : {
                    autoscale : true
                },
                title : name
            };

            Flotr.draw(
                container,
                [{ data : data, label : field, lines : { fill : true } }],
                options
            );

        }

        container = (document.getElementById('graph'));
        basic_time(container, {{ data }}, '{{ selected_field }}', '{{ name }}');
    </script>
    <script src="{{ url_for('static', filename='js/jquery-1.7.2.min.js') }}"></script>
{% endblock %}
